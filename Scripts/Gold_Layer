------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------- Customer Information Table--------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

--- We have 2 columns for gender so we are need to identify if anything is not consistent and what is the master record for gender 
WITH full_cust_info as(
SELECT cc.cst_id, cc.cst_key,cc.cst_firstname,cc.cst_lastname,cc.cst_marital_status,cc.cst_gndr,cc.cst_create_date
,ec.bdate,ec.gen,
el.cntry
FROM silver.crm_cust_info cc
LEFT JOIN silver.erp_cust_az12 ec on
cc.cst_key = ec.cid
LEFT JOIN silver.erp_loc_a101 el on
cc.cst_key = el.cid)

SELECT DISTINCT cst_gndr,gen
FROM full_cust_info ;
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------FInal Customer INformation after adjusting gender--------------------------------------------------------------------

SELECT cc.cst_id AS customer_id, cc.cst_key AS customer_number,cc.cst_firstname AS firstname,cc.cst_lastname AS last_name,cc.cst_marital_status AS marital_status,COALESCE(CASE WHEN
			cst_gndr = 'n/a' THEN gen
			ELSE cst_gndr
			END, 'n/a') AS gender,cc.cst_create_date AS create_date
,ec.bdate AS birthdate,
el.cntry AS country
FROM silver.crm_cust_info cc
LEFT JOIN silver.erp_cust_az12 ec on
cc.cst_key = ec.cid
LEFT JOIN silver.erp_loc_a101 el on
cc.cst_key = el.cid

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------
